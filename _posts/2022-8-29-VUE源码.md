---
layout: post
title:  "Vue源码"
date:   2022-08-29 19:28:51 +0800
categories: Vue
---







# VUE源码

## 一、rollup配置

> vue 库采用 rollup 进行打包
>
> 1. npm init
> 2. 安装依赖
> 3. 配置 rollup.config.js 文件
> 4. 配置 babel
> 5. 添加运行脚本
> 6. 创建 src/index.js
> 7. 创建 public/index.html 

## 二、源码分析

###  1. vue-options

+ 把 data 等数据通过选项对象传递给 Vue 构造函数，构造函数接收参数并传递给` initMixin()`方法,内部通过 ` _init()` 接收。
+  ` _init()` 中真正的是通过 `initState()` 中的 `initData（）`进行初始化 data 。
+ 判断 data 数据类型，如果是函数，那么就通过 `data.call（vm）`调用，如果是对象，直接返回对象，接下来将要对数据进行劫持。

### 1. 数据劫持

+ 在 `initData()` 中调用 `observer()` 把数据传递过去。
+ 先判断数据是否为对象，不为对象不进行劫持，若为对象则传递到`new Oberver()` 中的`walk()` 中进行对象循环。
+ 再调用`defineReactive()` 对每一个数据劫持，继续调用`obverser()` 
+ 处理直接通过 this 访问到 data 中的数据，在`initData()` 中调用 `proxy()` 对vm进行劫持，当访问vm的数据时，将 vm 上的data代理到 _data 上，再次触发 `observer()` 进行数据劫持。

![初始化和劫持](D:\博客\TCIano-blog\_site\assets\vue源码数据初始化和数据劫持.png)



